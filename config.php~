<?php
///////////////////////////////////////////////////////////////////////////////
#
# Configuration file contains sensitive information. Do not publish this-
# in svn or any other public sourses
#
#******************************************************************************

require_once("app/config.php");

class site_config extends common_config
{
    function __construct() {
        parent::__construct();

        $this->webapi_user = "goc";
        $this->webapi_password = "5be1499a577add53307142asdaq2WSagsASDGa";

        $this->banner = "This is a ITB instance. This URL could disappear anytime or maybe unstable. For production use, please use <a href=\"https://ticket.grid.iu.edu\">https://ticket.grid.iu.edu</a>";

	/////////////////////////////////////////////////////////////////////////
	//development
	$this->project_id = "114"; //dev
	//$this->project_id = "71"; //prod
        $this->editor_teams = array(
            array(0,1,3),
            array(7),
            array(6,4,2)
        );

	/////////////////////////////////////////////////////////////////////////
	//production
        //If you use production, make sure to adjust DB params to point to various production instances
/*
	$this->project_id = "71"; 
        $this->editor_teams = array(
            array(0,1,4),
            array(7,2),
            array(5,6)
        );
        //list of teams to show under navigator / assignee
        $this->navigator_assignee_list = array(0,1,4,5,6,7);
*/
	/////////////////////////////////////////////////////////////////////////


        $this->db_params = array(
            "oim" => array(
                array(
                    'charset' => 'UTF8',
                    'host'     => "localhost",
                    'username' => "ticket",
                    'password' => "qweasdzxc",
                    'dbname'   => "oim"
                )
            ),
            "data" => array(
                array(
                    'charset' => 'UTF8',
                    'host'     => "data-itb.goc",
                    'username' => "ticket",
                    'password' => "qweasdzxc",
                    'dbname'   => "log"
                )
            ),
            "tx" => array(
                array(
                    'charset' => 'UTF8',
                    'host'     => "data-itb.goc",
                    'username' => "ticket",
                    'password' => "qweasdzxc",
                    'dbname'   => "tx"
                )
            )
        );


        $this->debug = true;
        $this->profile_db = false;
	$this->simulate = false;

        //Safari has bug which does not allow users with no SSL cert
        $this->force_https = true;

        $this->elog_email = true;
        //$this->elog_email_address = "goc-alert@googlegroups.com";
        $this->elog_email_address = "schmeics@indiana.edu";
        $this->error_sms_to = array();
        $this->sms_notification = array(
            1=>/*critical*/     array("schmiecs"),
            2=>/*high*/         array("schmiecs"),
            3=>/*elevated*/     array("schmiecs"),
            4=>/*normal*/       array()
        );


        //blogger rss host settings
        $this->blogger_user = "goc@opensciencegrid.org";
        $this->blogger_pass = "goc345#pw";
        $this->blogger_blogid = "8655502542409107166"; //production is "431350066248299528";
	$this->blogger_client_email = "519645157260-2ktki0gh7bpa9o73nja82pdcgre8dg8q@developer.gserviceaccount.com";
	$this->blogger_p12 = "/usr/local/ticket/ticket.p12";

        $this->urchin_account = "UA-69012-13";

        $this->signed_email_key = "/etc/grid-security/user/key.pem";
        $this->signed_email_cert = "/etc/grid-security/user/cert.pem";

	$this->group_xml_path = "/tmp/ticket.goc.groupticket.xml";

	#$this->cometd_url = "http://ticket-itb.grid.iu.edu:8080/gocticket_comet/cometd";
	//$this->dn_override = array("/DC=org/DC=doegrids/OU=People/CN=Soichi Hayashi 461343"=>"/DC=org/DC=doegrids/OU=People/CN=Derek Weitzel 285345");
	$this->cometd_url = "http://comet-itb.grid.iu.edu:8080/cometd";

	//recapcha config
        //$this->captcha_public_key = "6LcpVdISAAAAADJkwM-ds53w65tcRFHQnd0JuYiR";
        //$this->captcha_private_key = "6LcpVdISAAAAAILIBZdPPXV5O5VdGvRZHW45cco5";
        $this->captcha_public_key = "6Ld6v9wSAAAAAAf8n60q3JpqiI3n6DXR9pRo41og";
        $this->captcha_private_key = "6Ld6v9wSAAAAAH0_5KDQSCzY2DhucSRchS09hzTu";

        $this->event_host = "event-itb.goc";
        $this->event_pass = "3c894242";

	$this->akismet_key = "b3c9e239bf6b";

        // the same 2 lines need to be added to the production servers 

	$this->chatjs_url = "https://ticket-itb.grid.iu.edu:8443"; //url used by client's browser
        $this->local_chatjs_url = "http://ticket-itb.goc:8080"; //used to make localhost request from php server

	/////////////////////////////////////////////////////////////////////////////////////////////
	// moved
        //Google Search aPI key
        $this->google_search_api_key = "AIzaSyAIommV_PJUjC36Y9wwdndFwqzz4QLhpTs";
        $this->google_custom_search_cx = "016752695275174109936:9u1k_fz_bag";

        $this->gocip = array(
            "129.79.53.", //GOC eth0 IPV4 VLAN
            "2001:18e8:2:6:", //GOC eth0 IPV6 VLAN
            "fd2f:6feb:37:", //GOC eth1 IPV6 VLAN
	    "156.56.179." //CIB - test from my vm
        );//GOC VLAN
        //define who gets SMS notification based on different priority
        $this->sms_notification = array(
            1=>/*critical*/     array("hayashis", "steige", "rquick", "kagross"),
            2=>/*high*/         array("hayashis"),
            3=>/*elevated*/     array("hayashis"),
            4=>/*normal*/       array()
        );

        $this->sms_address = array(
            "hayashis"=>"8126067104@txt.att.net", 
            "steige"=>  "steige@vtext.com", 
            "rquick"=>  "3176953276@txt.att.net",
            "kagross"=>  "8123226660@vtext.com"
        );

        $this->goc_staff = array("hayashis", "agopu", "steige", "thomlee", "rquick", "kagross", "echism", "cpipes", "adeximo");
        $this->oim_db_params = array(
            array(
                'unix_socket'     => '/usr/local/rsv-gratia-collector-1.0/vdt-app-data/mysql5/var/mysql.sock',
                'host'     => "localhost",
                'username' => "ticket",
                'password' => "somepass",
                'dbname'   => "oimnew",
                'port'     => 49152
            )
        );
    }

    function lookupFPID($txid, $tid) 
    {
        switch($txid) {
        case "fp114_ggus1": return array("TX_FP114_GGUS1", "https://test.ggus.eu/ggus/?mode=ticket_info&ticket_id=$tid");
        case "fp114_ggus2": return array("TX_FP114_GGUS2", "https://ggus.eu/ws/ticket_info.php?ticket=$tid");
        case "fp114_rtgocdev": return array("TX_FP114_RTGOCDEV", "https://soichi6.grid.iu.edu/rt/Ticket/Display.html?id=$tid");
        case "fp114_rtbnlprod": return array("TX_FP114_RTBNLPROD", null);
        case "fp71_ggus1": return array("TX_FP71_GGUS1", "https://test.ggus.eu/ggus/?mode=ticket_info&ticket_id=$tid");
        case "fp71_ggus2": return array("TX_FP71_GGUS2", "https://ggus.eu/ws/ticket_info.php?ticket=$tid");
        case "fp71_rtgocdev": return array("TX_FP71_RTGOCDEV", "https://soichi6.grid.iu.edu/rt/Ticket/Display.html?id=$tid");
        case "fp71_rtbnlprod": return array("TX_FP71_RTBNLPROD", null);

        case "fp114_rtvdttest": return array("TX_FP114_RTVDTTEST", null);
        case "fp71_rtvdtprod": return array("TX_FP71_RTVDTPROD", null);

        case "fp114_fermitest": return array("TX_FP114_FERMITEST", "https://fermitrn.service-now.com/nav_to.do?uri=incident.do?sys_id=$tid");
        case "fp114_fermidev": return array("TX_FP114_FERMIDEV", "https://fermidev.service-now.com/nav_to.do?uri=incident.do?sys_id=$tid");
        case "fp71_fermi": return array("TX_FP71_FERMI", "https://fermi.service-now.com/nav_to.do?uri=incident.do?sys_id=$tid");

        //deprecated, by hit by Google
        case "fp114_rt1": return array("TX_FP114_RT1", null);

        case "fp114_xsedetest": return array("TX_FP114_XSEDETEST", "https://newtickets.xsede.org/Ticket/Display.html?id=$tid");
        case "fp71_xsede": return array("TX_FP71_XSEDE", "https://newtickets.xsede.org/Ticket/Display.html?id=$tid");
        case "fp114_osgjiratest": 
            $json = file_get_contents("https://goctx-test:goctx#3cqwe@jira.opensciencegrid.org/rest/api/2/issue/$tid?fields=summary");
            $ret = json_decode($json);
            return array("TX_FP114_OSGJIRATEST", "https://jira.opensciencegrid.org/browse/".$ret->key, $ret->key); 
        case "fp71_osgjira":
            $json = file_get_contents("https://goctx:goctx#7GiQOiL@jira.opensciencegrid.org/rest/api/2/issue/$tid?fields=summary");
            $ret = json_decode($json);
            return array("TX_FP71_OSGJIRA", "https://jira.opensciencegrid.org/browse/".$ret->key, $ret->key);
        }
        wlog("Unknown TXID passed to lookupFPID: $txid");
        return null;
    }
}

$g_config = new site_config;
function config() { global $g_config; return $g_config; }


